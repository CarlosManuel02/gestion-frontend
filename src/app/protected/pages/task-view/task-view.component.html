@if (task) {
  <div nz-row>
    <div class="container-fluid mt-3" nz-col nzSpan="18">
      <nz-affix [nzOffsetTop]="0">
        <nz-breadcrumb style="background-color: #1c1c1c; z-index: 1;">
          <nz-breadcrumb-item>Project</nz-breadcrumb-item>
          <nz-breadcrumb-item>
            <a>{{ task.project_name }}</a>
          </nz-breadcrumb-item>
          <nz-breadcrumb-item>
            <a>{{ task.task_name }}</a>
          </nz-breadcrumb-item>
        </nz-breadcrumb>
      </nz-affix>

      <h3>{{ task.task_name }}</h3>
      <nz-button-group>
        <button nz-button nzType="default" disabled>Attach</button>
        <button nz-button nzType="default" disabled>M</button>
        <button nz-button nzType="default" disabled>R</button>
      </nz-button-group>
      <nz-divider></nz-divider>

      <p>Description</p>
      <div>
      <textarea nz-input
                [(ngModel)]="task.task_description"
                rows="10" [readonly]="editMode"
                (dblclick)="changeMode()"
                style="resize: none;"></textarea>
        @if (!editMode) {
          <nz-button-group>
            <button nz-button nzType="default" (click)="save()">Save</button>
            <button nz-button nzDanger nzType="default" (click)="cancel()">Cancel</button>
          </nz-button-group>
        }
      </div>

      @if (task.attachments) {
        <div class="mt-2">
          <p>Attachments
            <nz-tag>{{ task.attachments.length }}</nz-tag>
            <button nz-button nzType="text" nzSize="small"><span nz-icon nzType="plus" nzTheme="outline"></span>
            </button>
          </p>
          <nz-list nzSplit="false">
            @for (file of task?.attachments; track file) {
              <nz-list-item>
                <span>{{ file.file_name }}</span>
                <nz-button-group>
                  <button [nzLoading]="loading" nz-button nzType="primary" nzSize="small" (click)="download(file)">
                    Download
                  </button>
                </nz-button-group>
              </nz-list-item>
            }
          </nz-list>
        </div>
      }
    </div>

    <div nz-col nzSpan="6">
      <nz-card nzTitle="Task Details">
        <form nz-form>
          <nz-form-item>
            <nz-form-label nzSpan="8">Project</nz-form-label>
            <nz-form-control>
              <input [nzBorderless]="editModeDetails" class="float-right" nz-input [value]="task.project_name" [readonly]="editModeDetails" (click)="changeModeDetails()">
            </nz-form-control>
          </nz-form-item>
          <nz-form-item>
            <nz-form-label nzSpan="8">Task</nz-form-label>
            <nz-form-control>
              <input [nzBorderless]="editModeDetails" class="float-right" nz-input [value]="task.task_name" [readonly]="editModeDetails" (click)="changeModeDetails()">
            </nz-form-control>
          </nz-form-item>
          <nz-form-item>
            <nz-form-label nzSpan="8">Status</nz-form-label>
            <nz-form-control>
              <input [nzBorderless]="editModeDetails" class="float-right" nz-input [value]="task.task_status" [readonly]="editModeDetails" (click)="changeModeDetails()">
            </nz-form-control>
          </nz-form-item>
          <nz-form-item>
            <nz-form-label nzSpan="8">Priority</nz-form-label>
            <nz-form-control>
              <nz-select [nzBorderless]="editModeDetails" class="float-right" [(ngModel)]="task.task_priority" [disabled]="editModeDetails"
                         [ngModelOptions]="{standalone: true}" (click)="changeModeDetails()">
                <nz-option *ngFor="let priority of priorities" [nzLabel]="priority.label"
                           [nzValue]="priority.value"></nz-option>
              </nz-select>
            </nz-form-control>
          </nz-form-item>
          <nz-form-item>
            <nz-form-label nzSpan="8">Start Date</nz-form-label>
            <nz-form-control>
              <input [nzBorderless]="editModeDetails" class="float-right" nz-input [value]="task.task_creation_date | date: 'dd/MM/yyyy'" [readonly]="editModeDetails" (click)="changeModeDetails()">
            </nz-form-control>
          </nz-form-item>
          <nz-form-item>
            <nz-form-label nzSpan="8">End Date</nz-form-label>
            <nz-form-control>
              <input [nzBorderless]="editModeDetails" class="float-right" nz-input [value]="task.task_deadline | date: 'dd/MM/yyyy'"[readonly]="editModeDetails" (click)="changeModeDetails()">
            </nz-form-control>
          </nz-form-item>
          <nz-form-item>
            <nz-form-label nzSpan="8">Assigned To</nz-form-label>
            <nz-form-control>
              <input [nzBorderless]="editModeDetails" class="float-right" nz-input [value]="task.user_email" [readonly]="editModeDetails" (click)="changeModeDetails()">
            </nz-form-control>
          </nz-form-item>
        </form>
      </nz-card>
    </div>

  </div>

}
